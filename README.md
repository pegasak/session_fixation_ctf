# CTF Challenge: Session Fixation Attack

Это CTF-задание демонстрирует уязвимость **Session Fixation**. Участникам необходимо воспользоваться этой уязвимостью, чтобы получить доступ к аккаунту администратора и получить флаг.

---

##  Суть уязвимости

Приложение позволяет клиенту **задать свой `session_id` вручную**, а затем этот `session_id` может быть привязан к аккаунту администратора, если админ перейдёт по специально сформированной ссылке. Это и есть атака **session fixation**.

---

##  Почему это работает

- При логине приложение **не генерирует новый `session_id`**, а принимает тот, что пришёл от клиента.
- Таким образом, атакующий может заранее сгенерировать `session_id`, затем "заставить" администратора залогиниться с этим идентификатором.
- После этого атакующий сам может использовать тот же `session_id` — и получить доступ как админ.

---

##  Как защититься

1. **Никогда не принимать `session_id` от клиента** — сервер должен сам генерировать идентификаторы сессий.
2. **Сброс `session_id` при логине** — при каждой аутентификации нужно создавать новую сессию.
3. Использовать флаги `HttpOnly`, `Secure`, и `SameSite` для cookies.
4. Логировать и мониторить входы с разных IP по одному `session_id`.
5. Использовать современные механизмы аутентификации: JWT, OAuth и пр.

---

##  Что нужно сделать участнику

1. Перейти на [`/generate_session`](http://localhost:5000/generate_session) и скопировать сгенерированный `session_id`.
2. Сформировать вредоносную ссылку: 
http://localhost:5000/login?username=admin&session_id=<YOUR_SESSION_ID>
3. Отправить эту ссылку администратору через эндпоинт [`/send_to_admin`](http://localhost:5000/send_to_admin?url=...):
/send_to_admin?url=http://localhost:5000/login?username=admin&session_id=<ВАШ_SESSION_ID>
>  Даже если в ответ придёт сообщение "не удалось залогиниться", сессия всё равно будет привязана к администратору.
4. Перейти на [`/login`](http://localhost:5000/login), ввести:
- `username`: `admin`
- `password`: любое (можно неправильное)
- `session_id`: тот самый `session_id`
5. После входа вы попадёте в `/dashboard` как админ и увидите флаг.

---

##  Запуск через Docker

### Требования

- Docker
- Docker Compose

### Инструкция по запуску

```bash
git clone https://github.com/pegasak/session_fixation_ctf.git
cd session_fixation_ctf

# Запуск контейнера
docker-compose up --build
После запуска приложение будет доступно по адресу:
http://localhost:5000