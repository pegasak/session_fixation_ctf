# CTF Challenge: Session Fixation Attack

Это CTF-задание демонстрирует **атаку session fixation**. Участникам необходимо использовать уязвимость для входа в систему от имени администратора и получения флага.

---

##  Суть уязвимости

Во время GET-запроса к `/login?username=admin&session_id=...` сервер сохраняет сессию `session_id` как привязанную к пользователю admin. Это позволяет атакующему **заранее сгенерировать сессию**, привязать её к администратору, и дождаться, пока админ зайдёт по вредоносной ссылке.

---
## Почему это происходит?

- Приложение принимает session_id от пользователя и напрямую сохраняет его в серверном хранилище сессий, без генерации нового идентификатора при логине.
- Отсутствует проверка и ограничение на присваивание session_id другим пользователям.
- Это даёт возможность атакующему «зафиксировать» сессию и получить доступ от имени другого пользователя.

---

## Способы защиты

1. **Генерировать новый session_id при каждом логине** — не принимать заранее заданные session_id от пользователя.
2. **Использовать HttpOnly и Secure cookie флаги** для защиты cookies.
3. **Ограничить время жизни сессии** и мониторить подозрительную активность.
4. **Использовать безопасные механизмы аутентификации и сессий**, например, JWT с коротким сроком действия.
5. **Проверять входные данные и не принимать session_id извне** — создавать их только на сервере.
---

## ✅ Что нужно сделать участнику

1. Перейти на `/generate_session`, скопировать свой `session_id`.
2. Отправить ссылку администратору через эндпоинт `/send_to_admin`:  
http://localhost:5000/login?username=admin&session_id=<YOUR_SESSION_ID>
3. Дождаться, пока админ посетит ссылку.
4. Перейти на `/login`, ввести имя `admin` и тот же `session_id`.
5. Получить флаг в `/dashboard`.

---

##  Запуск в Docker

###  Требования
- Docker
- Docker Compose

###  Инструкция по запуску

```bash
git clone git@github.com:pegasak/session_fixation_ctf.git
cd session-fixation-ctf

# Запуск
docker-compose up --build
